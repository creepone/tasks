extends layout

block head
  title Tasks
  script(src="/js/index.js")
  link(rel="stylesheet",href="/styles/index.css")
  script.data(type="text/json")!= JSON.stringify(data)

block header-content
    a.navbar-text.has-popover#devices(href="#"): i.glyphicon.glyphicon-phone
    a.navbar-text.has-popover#notifications(href="#"): i.glyphicon.glyphicon-bell
    .navbar-right
      p.navbar-text= username
      a.navbar-text#logout(href="#"): i.glyphicon.glyphicon-eject

block content
  #loader
    .well.well-transparent.lead.text-center
      img(src="../img/spinner.gif")

  button.btn.btn-sm.btn-primary#addTask(type="button") Add Task
  hr

  #tasks

  #oldTasks(data-bind="foreach: tasks")
    .task(data-bind="attr: { 'data-id': _id }")
      .actions
        button.removeTask.close: i.glyphicon.glyphicon-remove
        button.editTask.close: i.glyphicon.glyphicon-pencil
      h4.name(data-bind="text: name, css: { 'text-info': !isDue(), 'text-danger': isDue() }")
      div(data-bind="if: $data.reminder")
        p: small.time(data-bind="text: reminder.timeText, attr: { 'data-important': reminder.important }")
      div(data-bind="foreach: categories")
        span.label.label-default(data-bind="text: $data")
      pre(data-bind="if: $data.notes")
        small(data-bind="text: notes")
      hr

  script#devicesTemplate(type="text/html").
    <div class="popoverDevices" data-bind="foreach: devices">
      <div>
        <i class="glyphicon glyphicon-ok" data-bind="visible: !needsSync" />
        <i class="glyphicon glyphicon-refresh" data-bind="visible: needsSync" />
        <small><strong data-bind="text: name" /></small>
      </div>
      <div>
        <small data-bind="text: version" />
      </div>
      <hr />
    </div>
    <small data-bind="visible: devices.length == 0">No devices configured.</small>

  script#notificationsTemplate(type="text/html").
    <div class="popoverNotifications">
      <small><strong>Use notifications: </strong></small>
      <input type="checkbox" class="switch-small" />
    </div>

  script#deleteTemplate(type="text/html").
    <div class="popoverDelete">
      <p>Sure to delete the selected task ?</p>
      <div class="buttons">
        <button class="btn btn-xs btn-danger" type="submit">Delete</button>
        <button class="btn btn-xs btn-default" type="button">Cancel</button>
      </div>
    </div>

  script(id="task-template", type="text/template")
    include templates/task.html

  script(id="task-modal-template", type="text/template")
    include templates/task-modal.html